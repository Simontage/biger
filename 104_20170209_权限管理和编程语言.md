# 权限管理和编程语言

## 权限管理

对文件访问常用的权限有三种，分别是读，写，执行，简写为r，w，x

文件读（r）权限可以使用内容查看类的命令来显示相关内容

文件写（w）权限可以使用编辑器或者重定向来修改其内容

文件执行（x）权限可以将其发起一个进程

对于目录而言，读权限可以使用ls命令查看目录内容的文件信息；写权限可以在目录中创建和删除文件；执行权限可以使用ls -l命令查看目录内容的文件信息，并且可以使用cd命令切换至此目录为工作目录

文件权限有九位，每三个一组，分为用户权限组权限和其他用户的权限，当用户不拥有某位权限，使用-占位

每一位只有两种变化，有或者没有，可以使用二进制表示，三位二进制可以用一位八进制数字

000：---：0

**001：--x：1**

**010：-w-：2**

011：-wx：3

**100：r--：4**

101：r-x：5

110：rw-：6

111：rwx：7

文件的权限是文件的元数据信息，元数据保存在inode中

修改文件的属主和属组只有管理员可移植性，常用的有chown和chgrp

更改文件权限使用chmod

**文件权限的更改**

修改权限有三种方法：

- 一次性修改三类用户的权限，使用八进制指定的形式

\# chmod 754 file1

- 修改指定类别用户的权限，使用u，g，o，a来赋权，基于=或者+、-来进行

u表示属主，g表示属组，o表示其他用户，a表示所有，=操作指定类别用户的权限，+/-操作指定类别用户的单个权限

\# chmod u=rx File1

\# chmod u=rwx,g=rx,o= File1

\# chmod  u+x,o-x,+x File1 直接加或者减代表所有的用户增加或者删除某权限 

- 参照其他文件的权限为当前文件赋权

\# chmod --reference=参考文件 File1

修改目录的权限并不会更改目录内的文件权限，使用-R选项递归更改目录内的所有文件，对链接文件无效

所有符号链接的权限都为777，因为权限控制在指向文件的权限控制

**创建文件的默认权限**

创建文件的默认权限是使用666-umask，创建目录的默认权限是使用777-umask

umask是遮罩码，文件默认决不允许出现执行权限，一旦出现执行权限，则在执行权限位上加一

使用`umask 数值`就可以修改遮罩码，修改只对当前进程有效，如果要一直生效，则要写入配置文件

如果用户和基本组组名一致umask为002,否则为022

**修改文件的属主和属组**

支持-R递归选项和--reference

chown [option] Username file

chgrp [option] Groupname file

chown可以同时更改属主和属组 chown Username:Groupname file，也可以只更改属组 chown :Groupname file

属主和属组可以使用：或者.或者|分隔

**权限应用模型**

进程的属主，是否与文件的属主相同，如果相同，进程则以文件属主的的权限来访问文件；

否则进程的属主所属的组，是否其中之一与文件的属组相同；如果相同，进程则以文件的属组的权限来访问文件；

否则进程以文件的其他用户的权限来访问文件

## bash的其他特性

shell是人机交互接口，

## 练习

### 练习一

1.新建一个用户openstack，但不给其创建家目录；创建完成后使用su命令切换至此用户，查看其命令提示符以及PATH和HOME两个环境变量；

2.复制/etc/skel目录为home/openstack；

3.改变/home/openstack以及其内部文件的属主属组均为openstack；

4./home/openstack以及其内部文件，属组和其他用户没有任何访问权限

\# useradd -M openstack

\# su - openstack

\# echo  \$PATH \$HOME

\# su - root

\# 密码

\# cp -r /etc/skel /home/openstack

\# chown -R openstack：openstack  /home/openstack

\# chmod -R go= /home/openstack

\# su - openstack

\# echo  \$PATH \$HOME

### 练习二

1.新建系统组mysql；新建系统用户mysql，属于mysql组，要求其没有家目录且shell为sbin/nologin

\# groupadd -r mysql

\# useradd -r -s sbin/nologin -g mysql mysql

2.新建GID为600的组magedu；新建用户gentoo，要求其家目录为/users/gentoo，密码同用户名

\# groupadd -g 600 magedu

\# mkdir /users

\# useradd  -d /users/gentoo gentoo

\# passwd gentoo 

3.新建用户centos，其家目录为/users/centos，密码同用户名

\# useradd -d /users/centos centos 

\# passwd centos

4.新建用户www，其家目录为/users/www，删除www用户，但保留其家目录

\# useradd  -d /users/www www

\# userdel www

5.用户gentoo和centos均已magedu为其附加组

\# usermod -Ga magedu gentoo

\# usermod -Ga magedu centos







