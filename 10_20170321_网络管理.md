# 网络管理

将Linux主机接入网络中要指定ip和mask、路由、DNS服务器

linux主机网络接口命名方式

CentOS6

以太网：eth[0,1,2,3]

ppp：ppp[0,1,2,3]

## ifcfg命令家族配置ip、路由和DNS

ip地址和掩码的配置有两种方式，一种是静态指定，一种是动态分配，动态分配需要DHCP

静态指定有两种不同的命令组，一个是ifcfg组，另外是ip命令，ifcfg是比较传统的命令，ip命令比较新功能也更强大。除了使用ifcfg和ip命令，也可以直接编辑配置文件，system-config-network-tui(setup)是一个基于配置文件的前端配置工具，这样即使重启系统也能使配置生效。在centos7中，有nmcli、nmtui新工具更加强大。

ifconfig用来显示网络属性信息和配置网络，直接使用ifconfig可以列出当前活动的网络接口，也可以查看指定的网络接口， -a选项可以查看所有网络接口。

配置接口的ip地址使用：ifconfig Interface ip/mask [up|down]，ifconfig会立即生效（注意不是永久有效），启用或禁用混杂模式[-]promisc

### 路由管理

路由管理命令使用route命令，路由查看使用route -n，不加-n会反解为名字;

添加路由使用route add [-net|-host] target [netmask Num] gw 网关地址 dev 网络接口;

例如route add -host 192.168.5.6 gw 172.16.23.2 dev eth0；route add -net  192.168.0.0/24 gw 172.16.0.1 dev eth0

添加默认路由：route add -net 0.0.0.0 netmask 0.0.0.0 gw 172.16.0.1；route add default gw 172.16.0.1

删除路由使用route del [-net|host] target netmask Num

### DNS配置

DNS配置一般要通过文件来实现，DNS配置文件在/etc/resolv.conf，配置使用nameserver DNS_SERVER_IP1，最多可以配置三台DNS服务器。DNS服务是将完全限定域名FQDN解析为ip地址，反解析是将ip地址解析为FQDN。解析测试使用dig -t A FQDN，反解析dig -x IPaddress，也可以使用host，正解host -t A FQDN，反解host -t PTR IP

### 网络状态查看

netstat可以查看网络连接、路由表、接口状态、地址伪装连接和组播成员关系

显示网络连接：netstat [--tcp|-t] \[--udp|-u] [--raw|-r] \[--listening|-l] [--all|-a] \[--numeric|-n] [--extend|-e] \[--program|-p]，常用的组合有：-tan、-uan、-tnl、-unl

```
-t：tcp协议相关
-u：udp协议相关
-w：raw socket相关
-l：处于监听状态
-a：所有状态
-n：以数字显示ip和端口
-e：扩展格式
-p：显示相关进程及PID
```

显示路由表：   netstat {--route|-r} \[--numeric|-n] ,常用的组合有：

```
-r：显示内核路由表
-n：数字格式
```

显示接口统计数据：  netstat  {--interfaces|-I|-i} [--all|-a]\[--extend|-e]   [--verbose|-v]\[--program|-p][--numeric|-n]

例如：netstat -i、netstat -I iface

## ip命令家族配置ip、路由和DNS

