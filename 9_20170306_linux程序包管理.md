# linux程序包管理

## Linux软件包的基本概念

软件包的组成

二进制程序：/bin,/sbin,/usr/bin,/usr/sbin,/usr/local/bin,/usr/local/sbin...也可以自定义位置，在自定义目录下仍然会生成bin，sbin等目录，如/usr/local/{bin,sbin}，要想运行自定义位置的程序有可以指定绝对路径，也可以修改环境变量

自身库文件：/lib,/lib64,/usr/lib,/usr/lib64,/usr/local/lib,/usr/local/lib64...库也可以在特定安装路径，操作系统查找库也要在特定路径下查找，系统默认查找的库文件的配置文件在/etc/ld.so.conf，当要指定自定义程序的库文件时，建议在系统默认的库文件查找配置文件下为每一个自定义程序建立一个配置文件/etc/ld.so.conf/*.conf

ldd命令可以查看应用程序所依赖的共享库，一般使用格式是ldd 二进制命令的文件（可以使用命令引用\`which 命令\`）

配置文件：/etc或特定路径下的/etc

帮助文件：帮助文件有man文件、info文件、README等。man文件通常在/usr/share/man/，自定义的man文件同样需要单独配置以确保系统可以查找到，man的查找路径在配置文件/etc/man.config中，也可以使用man的-m选项，后加自定义的man文件路径，但这种方法至针对单次操作

为了便捷的管理这些软件包中的文件，所以使用应用程序管理器来管理应用程序

应用程序管理器维护一个数据库，并提供程序组成格式，一个应用程序管理器至少要具有这两种功能

数据库里面记录了安装的应用程序的软件名和版本、安装生成的各文件路径和校验码、依赖关系、功能性说明

应用程序组成格式里应该有文件清单、安装卸载运行的脚本、

依赖关系

依赖关系中有循环依赖和版本依赖

版本号

名称-主版本号.次版本号.修正版本号

Debian中使用.deb的程序包，使用dpkg这个应用程管理器管理应用程序

Redhat中使用.rpm的程序包，使用rpm应用程序管理器管理应用程序，后linux标准委员会将rpm吸纳为linux程序包标准管理工具

包管理器的基本功能

制作程序包

安装程序包

查询和升级

卸载

校验

数据库管理

为了解决依赖关系，就出现了软件包的前端管理器，前端管理器可以自动解决依赖关系并安装，比较著名的前端管理器有apt-get和yum

总结：应用程序的安装方式

使用包管理器安装，便捷易用的安装方式；使用包管理器的前端工具；使用源代码编译；简单打包的二进制格式；

来源合法性验证

对源程序要通过md5或sha1校验码验证

对软件包要使用发行商提供的软件包

## rpm包的使用

### rpm包命名的格式

源程序：

name-version.tar.{gz|bz|xz}，其中版本号包含主次和修正版本号major.minor.release

rpm包：

name-version-release.arch.rpm，rpm中的release通常包含rpm的制作发行号，还包含适用于的os

release表现为2.el6，其中2表示这是该软包的第二个版本，el6表示Redhat enterprise linux 6，类似的还有el5表示Redhat enterprise linux 5，CentOS5，suse1。

arch表示的是程序适用的cpu架构，一般的有x86_64、i386/i586/i686(x86平台32位)、ppc(powerPC)、noarch

也有一些软件包没有release和arch代表这是一个通用的软件包

### 分包

一个源码包有10个功能，大部分用户只使用6个，那剩余4个功能如何处理？

分包将一个大的应用程序打包制作成多个包，支包的名称会跟在核心包名（主包名）的后面，例如主包为bind，支包为bind-devel、bind-libs、bind-utils

### 验证

验证包完整性和合法性，包完整性通过校验码验证，来源合法性通过开发者的公钥验证，实际上需要证书

### rpm包获取

通过发行商的光盘或站点服务器；

通过可信的第三方网站，如rpmfind.net、rpm.pbone.net

